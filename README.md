# MenuAI â€“ AI Meal Planner

MenuAI is a Nuxt 3 full-stack application that helps households plan a week of meals and automatically prepares a grocery shopping list using Google Gemini. The MVP is tuned for a single-instance deployment that can comfortably handle ~1,000 users.

## Features
- Phone/password authentication powered by Supabase
- Weekly 7-day meal plans (breakfast, lunch, dinner) plus grocery list generated by Gemini `gemini-1.5-pro`
- Free tier (1 plan per week) and mock Pro subscription (unlimited plans, diet & kids presets)
- Dashboard to view the most recent plan, regenerate, and export groceries to PDF
- Meal plan generator form with Ant Design Vue components
- Profile & subscription settings backed by Prisma + PostgreSQL
- Mock checkout flow that upgrades the account immediately

## Tech Stack
- **Nuxt 3** for both frontend UI and server routes (`/server/api`)
- **Ant Design Vue** for UI components & layout
- **Pinia** for client-side state management
- **Supabase Auth** for JWT-protected endpoints (via `@nuxtjs/supabase`)
- **Prisma** ORM with PostgreSQL (local or hosted / Supabase)
- **Google Gemini** SDK for AI generation
- **jsPDF** for client-side PDF export

## Getting Started

### Prerequisites
- Node.js 18+
- PostgreSQL database (Supabase or self-hosted)
- Google Gemini API key
- Supabase project (optional but recommended for managed auth)

### Installation
```bash
npm install
```

### Environment Variables
Copy `config/env.example` to `.env` and fill in the values:
```bash
cp config/env.example .env
```

| Variable | Description |
|----------|-------------|
| `GEMINI_API_KEY` | Google Gemini API key |
| `NUXT_PUBLIC_SUPABASE_URL` | Supabase project URL |
| `NUXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase anonymous key |
| `NUXT_PUBLIC_APP_URL` | Base URL of the deployed app |
| `NUXT_PUBLIC_PRO_PRICE_ID` | Mock price identifier (used in UI only) |
| `DATABASE_URL` | PostgreSQL connection string |
| `SUPABASE_SERVICE_ROLE_KEY` | Optional, for admin operations |

### Database
Run Prisma migrations and generate the client:
```bash
# Development: generates with query engines (needed for local dev)
npm run db:generate

# Production: generates without engines (smaller bundle, use in CI/CD)
npm run db:generate:prod

# For production migrations
npm run db:migrate

# Optional: open Prisma Studio
npm run db:studio
```

**Note**: The `--no-engine` flag is recommended for production builds to reduce bundle size. Use `db:generate` for development and `db:generate:prod` for production deployments.

### Development
```bash
npm run dev
```
The app is served at `http://localhost:3000`.

### Production Build
```bash
npm run build
npm run preview
```

## Project Structure (abridged)
```
app/                # Nuxt app-level components
assets/             # Global styles (Ant Design overrides)
layouts/            # Default layout with header/footer
middleware/         # Auth middleware
pages/              # Nuxt pages (landing, auth, dashboard, etc.)
plugins/            # Ant Design Vue plugin
prisma/             # Prisma schema and migrations
server/api/         # Backend API routes (meal plans, profile, subscription)
server/services/    # Gemini integration
server/utils/       # Prisma client, Supabase auth helpers
stores/             # Pinia store for user & meal plan state
```

## Deployment Notes
- Designed to run on Vercel, Render, or Supabase Edge Functions (Nitro preset configurable via `NITRO_PRESET`).
- Store `GEMINI_API_KEY`, Supabase credentials, and `DATABASE_URL` as secrets.
- Single instance with pooled PostgreSQL and Prisma can comfortably support ~1,000 active users for the MVP.

## Testing AI Integration
The Gemini integration runs server-side. Ensure the API key has access to `gemini-1.5-pro`. In development, the meal plan endpoint logs JSON parse issues from the model for easier debugging.

## Next Steps
- Swap the mock checkout with real Stripe Checkout
- Add phone notifications for new meal plans
- Implement plan history browsing and sharing
